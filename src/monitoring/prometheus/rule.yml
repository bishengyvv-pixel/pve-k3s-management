groups:
- name: k3s-node-immediate-alerts
  rules:
  - alert: HighCPULoad_Immediate
    expr: 100 - (avg by (instance) (rate(node_cpu_seconds_total{mode="idle"}[5s])) * 100) > 60
    for: 0s 
    labels:
      severity: warning
      owner: infrastructure
      reaction: AutoOperate
    annotations:
      summary: "【瞬时警告】节点 CPU 负载过高 (大于 60%)"
      description: "节点 {{ $labels.instance }} 的瞬时 CPU 使用率在过去 5 秒内超过 60% (当前值: {{ $value }}%)"

  - alert: UltraSensitiveCPULoad_Immediate
    expr: 100 - (avg by (instance) (rate(node_cpu_seconds_total{mode="idle"}[2s])) * 100) > 90
    for: 0s 
    labels:
      severity: critical
      owner: test-user
      reaction: AutoOperate
    annotations:
      summary: "【极限触发】CPU 负载超高 ( > 90%) - 触发自动运维"
      description: "节点 {{ $labels.instance }} 的 CPU 瞬时负载已在 2 秒窗口内超过 90% (当前值: {{ $value }}%)"